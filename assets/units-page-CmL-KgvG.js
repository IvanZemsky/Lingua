import{d as _,r as k,i as U,j as v,u as e,c as f,o as u,w as n,m as y,k as j,a as m,g as O,n as W,l as X,f as h,p as b,q as A,s as K,v as Y,t as F,b as x,x as J,y as I,F as T,h as z,R as Z,e as ee,z as te,A as se,B as ae,C as oe}from"./index-C7CTL063.js";import{u as re,c as ne,b as D,P as B,d as q,_ as le,a as ue}from"./card-content.vue_vue_type_script_setup_true_lang-CAfnN04Q.js";import{u as E,g as N,D as ie,F as de,a as R,b as pe,P as V,c as ce,T as fe,d as H,e as M,X as _e,f as ge,h as me,_ as P}from"./x-DcrqWxs8.js";import{a as ve,_ as ye}from"./card-title.vue_vue_type_script_setup_true_lang-qMVmJHNP.js";function he(o,s,t,a){return`/sections/${o}/units/${s}/lessons/${t}/variants/${a}`}const[C,be]=ne("DialogRoot");var De=_({inheritAttrs:!1,__name:"DialogRoot",props:{open:{type:Boolean,required:!1,default:void 0},defaultOpen:{type:Boolean,required:!1,default:!1},modal:{type:Boolean,required:!1,default:!0}},emits:["update:open"],setup(o,{emit:s}){const t=o,r=re(t,"open",s,{defaultValue:t.defaultOpen,passive:t.open===void 0}),i=k(),p=k(),{modal:d}=U(t);return be({open:r,modal:d,openModal:()=>{r.value=!0},onOpenChange:l=>{r.value=l},onOpenToggle:()=>{r.value=!r.value},contentId:"",titleId:"",descriptionId:"",triggerElement:i,contentElement:p}),(l,c)=>v(l.$slots,"default",{open:e(r),close:()=>r.value=!1})}}),Ce=De,we=_({__name:"DialogClose",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(o){const s=o;D();const t=C();return(a,r)=>(u(),f(e(B),y(s,{type:a.as==="button"?"button":void 0,onClick:r[0]||(r[0]=i=>e(t).onOpenChange(!1))}),{default:n(()=>[v(a.$slots,"default")]),_:3},16,["type"]))}}),G=we;function $e(o){return o?"open":"closed"}var ke=_({__name:"DialogContentImpl",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(o,{emit:s}){const t=o,a=s,r=C(),{forwardRef:i,currentElement:p}=D();return r.titleId||=E(void 0,"reka-dialog-title"),r.descriptionId||=E(void 0,"reka-dialog-description"),j(()=>{r.contentElement=p,N()!==document.body&&(r.triggerElement.value=N())}),(d,l)=>(u(),f(e(de),{"as-child":"",loop:"",trapped:t.trapFocus,onMountAutoFocus:l[5]||(l[5]=c=>a("openAutoFocus",c)),onUnmountAutoFocus:l[6]||(l[6]=c=>a("closeAutoFocus",c))},{default:n(()=>[m(e(ie),y({id:e(r).contentId,ref:e(i),as:d.as,"as-child":d.asChild,"disable-outside-pointer-events":d.disableOutsidePointerEvents,role:"dialog","aria-describedby":e(r).descriptionId,"aria-labelledby":e(r).titleId,"data-state":e($e)(e(r).open.value)},d.$attrs,{onDismiss:l[0]||(l[0]=c=>e(r).onOpenChange(!1)),onEscapeKeyDown:l[1]||(l[1]=c=>a("escapeKeyDown",c)),onFocusOutside:l[2]||(l[2]=c=>a("focusOutside",c)),onInteractOutside:l[3]||(l[3]=c=>a("interactOutside",c)),onPointerDownOutside:l[4]||(l[4]=c=>a("pointerDownOutside",c))}),{default:n(()=>[v(d.$slots,"default")]),_:3},16,["id","as","as-child","disable-outside-pointer-events","aria-describedby","aria-labelledby","data-state"])]),_:3},8,["trapped"]))}}),Q=ke,Oe=_({__name:"DialogContentModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(o,{emit:s}){const t=o,a=s,r=C(),i=R(a),{forwardRef:p,currentElement:d}=D();return pe(d),(l,c)=>(u(),f(Q,y({...t,...e(i)},{ref:e(p),"trap-focus":e(r).open.value,"disable-outside-pointer-events":!0,onCloseAutoFocus:c[0]||(c[0]=g=>{g.defaultPrevented||(g.preventDefault(),e(r).triggerElement.value?.focus())}),onPointerDownOutside:c[1]||(c[1]=g=>{const w=g.detail.originalEvent,$=w.button===0&&w.ctrlKey===!0;(w.button===2||$)&&g.preventDefault()}),onFocusOutside:c[2]||(c[2]=g=>{g.preventDefault()})}),{default:n(()=>[v(l.$slots,"default")]),_:3},16,["trap-focus"]))}}),xe=Oe,Be=_({__name:"DialogContentNonModal",props:{forceMount:{type:Boolean,required:!1},trapFocus:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(o,{emit:s}){const t=o,r=R(s);D();const i=C(),p=k(!1),d=k(!1);return(l,c)=>(u(),f(Q,y({...t,...e(r)},{"trap-focus":!1,"disable-outside-pointer-events":!1,onCloseAutoFocus:c[0]||(c[0]=g=>{g.defaultPrevented||(p.value||e(i).triggerElement.value?.focus(),g.preventDefault()),p.value=!1,d.value=!1}),onInteractOutside:c[1]||(c[1]=g=>{g.defaultPrevented||(p.value=!0,g.detail.originalEvent.type==="pointerdown"&&(d.value=!0));const w=g.target;e(i).triggerElement.value?.contains(w)&&g.preventDefault(),g.detail.originalEvent.type==="focusin"&&d.value&&g.preventDefault()})}),{default:n(()=>[v(l.$slots,"default")]),_:3},16))}}),qe=Be,Pe=_({__name:"DialogContent",props:{forceMount:{type:Boolean,required:!1},disableOutsidePointerEvents:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(o,{emit:s}){const t=o,a=s,r=C(),i=R(a),{forwardRef:p}=D();return(d,l)=>(u(),f(e(V),{present:d.forceMount||e(r).open.value},{default:n(()=>[e(r).modal.value?(u(),f(xe,y({key:0,ref:e(p)},{...t,...e(i),...d.$attrs}),{default:n(()=>[v(d.$slots,"default")]),_:3},16)):(u(),f(qe,y({key:1,ref:e(p)},{...t,...e(i),...d.$attrs}),{default:n(()=>[v(d.$slots,"default")]),_:3},16))]),_:3},8,["present"]))}}),Fe=Pe,Ee=_({__name:"DialogOverlayImpl",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(o){const s=C();return ce(!0),D(),(t,a)=>(u(),f(e(B),{as:t.as,"as-child":t.asChild,"data-state":e(s).open.value?"open":"closed",style:{"pointer-events":"auto"}},{default:n(()=>[v(t.$slots,"default")]),_:3},8,["as","as-child","data-state"]))}}),Ae=Ee,Ie=_({__name:"DialogOverlay",props:{forceMount:{type:Boolean,required:!1},asChild:{type:Boolean,required:!1},as:{type:null,required:!1}},setup(o){const s=C(),{forwardRef:t}=D();return(a,r)=>e(s)?.modal.value?(u(),f(e(V),{key:0,present:a.forceMount||e(s).open.value},{default:n(()=>[m(Ae,y(a.$attrs,{ref:e(t),as:a.as,"as-child":a.asChild}),{default:n(()=>[v(a.$slots,"default")]),_:3},16,["as","as-child"])]),_:3},8,["present"])):O("v-if",!0)}}),Re=Ie,Me=_({__name:"DialogPortal",props:{to:{type:null,required:!1},disabled:{type:Boolean,required:!1},defer:{type:Boolean,required:!1},forceMount:{type:Boolean,required:!1}},setup(o){const s=o;return(t,a)=>(u(),f(e(fe),W(X(s)),{default:n(()=>[v(t.$slots,"default")]),_:3},16))}}),Te=Me,ze=_({__name:"DialogTitle",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"h2"}},setup(o){const s=o,t=C();return D(),(a,r)=>(u(),f(e(B),y(s,{id:e(t).titleId}),{default:n(()=>[v(a.$slots,"default")]),_:3},16,["id"]))}}),Ne=ze,Se=_({__name:"DialogTrigger",props:{asChild:{type:Boolean,required:!1},as:{type:null,required:!1,default:"button"}},setup(o){const s=o,t=C(),{forwardRef:a,currentElement:r}=D();return t.contentId||=E(void 0,"reka-dialog-content"),j(()=>{t.triggerElement.value=r.value}),(i,p)=>(u(),f(e(B),y(s,{ref:e(a),type:i.as==="button"?"button":void 0,"aria-haspopup":"dialog","aria-expanded":e(t).open.value||!1,"aria-controls":e(t).open.value?e(t).contentId:void 0,"data-state":e(t).open.value?"open":"closed",onClick:e(t).onOpenToggle}),{default:n(()=>[v(i.$slots,"default")]),_:3},16,["type","aria-expanded","aria-controls","data-state","onClick"]))}}),Le=Se;const Ue={viewBox:"0 0 120 120"},je=["stroke-dashoffset"],Ke=_({__name:"donut-chart",props:{percentage:{},stroke:{}},setup(o){return(s,t)=>(u(),h("svg",Ue,[b("circle",{cx:"60",cy:"60",r:"50","stroke-width":"8",fill:"none","stroke-dasharray":"314","stroke-dashoffset":314*(1-s.percentage/100),"stroke-linecap":"round",transform:"rotate(-90 60 60)"},null,8,je)]))}}),Ve=_({__name:"UiDialog",props:{open:{type:Boolean},defaultOpen:{type:Boolean},modal:{type:Boolean}},emits:["update:open"],setup(o,{emit:s}){const r=H(o,s);return(i,p)=>(u(),f(e(Ce),y({"data-slot":"dialog"},e(r)),{default:n(()=>[v(i.$slots,"default")]),_:3},16))}}),S=_({__name:"DialogClose",props:{asChild:{type:Boolean},as:{}},setup(o){const s=o;return(t,a)=>(u(),f(e(G),y({"data-slot":"dialog-close"},s),{default:n(()=>[v(t.$slots,"default")]),_:3},16))}});/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=M("book-text",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=M("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=M("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Qe=_({__name:"DialogOverlay",props:{forceMount:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},setup(o){const s=o,t=A(s,"class");return(a,r)=>(u(),f(e(Re),y({"data-slot":"dialog-overlay"},e(t),{class:e(q)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",s.class)}),{default:n(()=>[v(a.$slots,"default")]),_:3},16,["class"]))}}),We=_({__name:"DialogContent",props:{forceMount:{type:Boolean},disableOutsidePointerEvents:{type:Boolean},asChild:{type:Boolean},as:{},class:{}},emits:["escapeKeyDown","pointerDownOutside","focusOutside","interactOutside","openAutoFocus","closeAutoFocus"],setup(o,{emit:s}){const t=o,a=s,r=A(t,"class"),i=H(r,a);return(p,d)=>(u(),f(e(Te),null,{default:n(()=>[m(Qe),m(e(Fe),y({"data-slot":"dialog-content"},e(i),{class:e(q)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",t.class)}),{default:n(()=>[v(p.$slots,"default"),m(e(G),{class:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4"},{default:n(()=>[m(e(_e)),d[0]||(d[0]=b("span",{class:"sr-only"},"Close",-1))]),_:1})]),_:3},16,["class"])]),_:3}))}}),Xe=_({__name:"DialogFooter",props:{class:{}},setup(o){const s=o;return(t,a)=>(u(),h("div",{"data-slot":"dialog-footer",class:K(e(q)("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",s.class))},[v(t.$slots,"default")],2))}}),Ye=_({__name:"DialogTitle",props:{asChild:{type:Boolean},as:{},class:{}},setup(o){const s=o,t=A(s,"class"),a=ge(t);return(r,i)=>(u(),f(e(Ne),y({"data-slot":"dialog-title"},e(a),{class:e(q)("text-lg leading-none font-semibold",s.class)}),{default:n(()=>[v(r.$slots,"default")]),_:3},16,["class"]))}}),Je=_({__name:"DialogTrigger",props:{asChild:{type:Boolean},as:{}},setup(o){const s=o;return(t,a)=>(u(),f(e(Le),y({"data-slot":"dialog-trigger"},s),{default:n(()=>[v(t.$slots,"default")]),_:3},16))}}),Ze=_({__name:"lesson-btn",props:{asChild:{type:Boolean},as:{default:"button"},status:{},class:{},percentage:{}},setup(o){const s=o,t={completed:Ge,unreached:L,active:L},a=me("relative w-17 h-17 flex items-center justify-center rounded-full z-3",{variants:{status:{active:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90 [&_svg]:fill-primary-foreground",unreached:"bg-gray-200 text-gray-800 shadow-xs hover:bg-gray-300 [&_svg]:fill-gray-800",completed:"bg-gray-200 text-gray-800 shadow-xs hover:bg-gray-300"}}});return(r,i)=>(u(),f(e(B),y(s,{"as-child":s.asChild,as:s.as,class:e(q)(e(a)({status:s.status}),s.class)}),{default:n(()=>[(u(),f(Y(t[s.status]),{class:"w-8 h-8 stroke-3"})),s.status==="active"?(u(),f(Ke,{key:0,percentage:r.percentage,class:"absolute w-24 h-24 -z-1 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 [&_circle]:stroke-slate-700",stroke:"red-700"},null,8,["percentage"])):O("",!0)]),_:1},16,["as-child","as","class"]))}}),et={class:"w-full flex items-center gap-2 mb-8"},tt={class:"font-bold text-gray-400 text-xl"},st=_({__name:"list-header",props:{title:{}},setup(o){return(s,t)=>(u(),h("h2",et,[t[0]||(t[0]=b("div",{class:"h-0.5 flex-grow bg-gray-200"},null,-1)),b("span",tt,F(s.title),1),t[1]||(t[1]=b("div",{class:"h-0.5 flex-grow bg-gray-200"},null,-1))]))}}),at={class:"font-bold text-lg text-gray-800"},ot={class:"flex items-center justify-center w-16 h-full"},rt=_({__name:"unit-desc-card",props:{title:{},subtitle:{}},setup(o){const s=o;return(t,a)=>(u(),f(e(le),{class:"relative z-40 flex-row gap-0 py-0"},{default:n(()=>[m(e(ye),{class:"gap-0 flex-grow p-4"},{default:n(()=>[m(e(ve),{class:"uppercase font-semibold text-gray-600"},{default:n(()=>[x(F(s.title),1)]),_:1}),b("p",at,F(s.subtitle),1)]),_:1}),m(e(ue),{class:"flex items-center p-0 border-l-2 border-gray-200"},{default:n(()=>[b("button",ot,[m(e(He),{class:"w-8 h-8 stroke-gray-800"})])]),_:1})]),_:1}))}});function nt(o){const s=k([]),t=k({unitTitle:o.value?.[0].title??"",unitNumber:o.value?.[0].number??0});J(s,i=>{const p=i.find(l=>l.isIntersecting);if(!p)return;const d=r(p.target);d&&a(d)},{threshold:.7});function a(i){const p=o.value?.find(d=>d.number===i)?.title;p&&(t.value={unitTitle:p,unitNumber:i})}function r(i){const p=i.getAttribute("data-unit");return p?parseInt(p):null}return{targetRefs:s,desc:t}}const lt={key:0},ut={key:1},it=["data-unit"],dt={class:"flex flex-col items-center gap-6"},pt=_({__name:"units-list",props:{sectionNumber:{},data:{},isFetching:{type:Boolean},error:{}},setup(o,{expose:s}){const t=o,{data:a}=U(t),r=k(null);s({root:r});const{targetRefs:i,desc:p}=nt(a),d=I();return(l,c)=>(u(),h("div",{class:"flex flex-col items-center gap-8",ref_key:"root",ref:r},[l.isFetching?(u(),h("p",lt,"Loading...")):O("",!0),l.error?(u(),h("p",ut,"An error occurred")):O("",!0),e(a)?.length&&e(p).unitTitle?(u(),f(rt,{key:2,title:`Section ${l.sectionNumber}, Unit ${e(p).unitNumber}`,subtitle:e(p).unitTitle,class:"fixed top-12 left-4 right-4"},null,8,["title","subtitle"])):O("",!0),(u(!0),h(T,null,z(e(a),(g,w)=>(u(),h("div",{class:K(["w-full",{"pt-30":w===0}]),key:g.number,"data-unit":g.number,ref_for:!0,ref_key:"targetRefs",ref:i},[w!==0?(u(),f(st,{key:0,title:g.title},null,8,["title"])):O("",!0),b("div",dt,[(u(!0),h(T,null,z(g.lessons,$=>(u(),f(Ze,{as:e(Z),status:$.status,to:e(he)(l.sectionNumber,g.number,$.number,e(d).progress.lesson.variant),key:$.number,percentage:(e(d).progress.lesson.variant-1)/$.totalVariants*100},null,8,["as","status","to","percentage"]))),128))])],10,it))),128))],512))}});function ct(o,s={}){return ee(`/sections/${o}/units`,s).json()}function ft(o,s){const t=te();se(o,async()=>{await a()});async function a(){if(!o.value?.length||!t.value?.root)return;await ae();const r=t.value.root;_t(r,s)}return{listRef:t}}function _t(o,s){const t=o.querySelector(`[data-unit="${s}"]`);t&&t.scrollIntoView({block:"start"})}const gt={class:"flex gap-4 items-center justify-center"},mt=_({__name:"reset-progress-btn",setup(o){const s=I();return(t,a)=>(u(),f(e(Ve),null,{default:n(()=>[m(e(Je),{"as-child":""},{default:n(()=>[m(e(P),{size:"sm"},{default:n(()=>[...a[0]||(a[0]=[x("Reset progress",-1)])]),_:1})]),_:1}),m(e(We),{class:"z-90"},{default:n(()=>[m(e(Ye),null,{default:n(()=>[...a[1]||(a[1]=[x("Are you sure you want to reset progress?",-1)])]),_:1}),m(e(Xe),null,{default:n(()=>[b("div",gt,[m(e(S),{"as-child":""},{default:n(()=>[m(e(P),null,{default:n(()=>[...a[2]||(a[2]=[x("Cancel",-1)])]),_:1})]),_:1}),m(e(S),{"as-child":""},{default:n(()=>[m(e(P),{type:"submit",variant:"destructive",onClick:e(s).reset},{default:n(()=>[...a[3]||(a[3]=[x(" Yes ",-1)])]),_:1},8,["onClick"])]),_:1})])]),_:1})]),_:1})]),_:1}))}}),vt={class:"relative"},yt={class:"fixed flex justify-center w-full py-2 top-0 left-0 right-0 bg-white z-40"},$t=_({__name:"units-page",setup(o){const s=oe(),t=parseInt(s.params.sectionNumber),a=I(),{data:r,isFetching:i,error:p}=ct(t,{afterFetch({data:l}){return l?(a.units=l,{data:a.convertUnitToUnitWithProgress(l)}):{data:l}}}),{listRef:d}=ft(r,a.progress.lesson.unit);return(l,c)=>(u(),h("div",vt,[b("div",yt,[m(e(mt))]),m(e(pt),{ref_key:"listRef",ref:d,sectionNumber:e(t),data:e(r),"is-fetching":e(i),error:e(p)},null,8,["sectionNumber","data","is-fetching","error"])]))}});export{$t as default};
