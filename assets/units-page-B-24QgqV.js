import{d as g,f as u,o as a,i as p,c as d,u as s,m as T,w as h,g as y,j as B,t as v,a as b,b as F,r as k,k as U,l as z,n as R,F as $,h as N,p as V,R as D,e as I,s as L,q as P,v as A,x as M}from"./index-BeDoqU1A.js";import{P as j,c as E,_ as q,a as H}from"./card-content.vue_vue_type_script_setup_true_lang-DaK6cNsF.js";import{c as x,a as G}from"./createLucideIcon-C-2m4hjq.js";import{_ as O,a as Q}from"./card-title.vue_vue_type_script_setup_true_lang-DQn1xIpU.js";const W={viewBox:"0 0 120 120"},J=["stroke-dashoffset"],K=g({__name:"donut-chart",props:{percentage:{},stroke:{}},setup(r){return(e,t)=>(a(),u("svg",W,[p("circle",{cx:"60",cy:"60",r:"50","stroke-width":"8",fill:"none","stroke-dasharray":"314","stroke-dashoffset":314*(1-e.percentage/100),"stroke-linecap":"round",transform:"rotate(-90 60 60)"},null,8,J)]))}});/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=x("book-text",[["path",{d:"M4 19.5v-15A2.5 2.5 0 0 1 6.5 2H19a1 1 0 0 1 1 1v18a1 1 0 0 1-1 1H6.5a1 1 0 0 1 0-5H20",key:"k3hazp"}],["path",{d:"M8 11h8",key:"vwpz6n"}],["path",{d:"M8 7h6",key:"1f0q6e"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Y=x("check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-vue-next v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const C=x("star",[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]]),Z=g({__name:"lesson-btn",props:{asChild:{type:Boolean},as:{default:"button"},status:{},class:{},percentage:{}},setup(r){const e=r;console.log(e.percentage);const t={completed:Y,unreached:C,active:C},n=G("relative w-17 h-17 flex items-center justify-center rounded-full z-3",{variants:{status:{active:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90 [&_svg]:fill-primary-foreground",unreached:"bg-gray-200 text-gray-800 shadow-xs hover:bg-gray-300 [&_svg]:fill-gray-800",completed:"bg-gray-200 text-gray-800 shadow-xs hover:bg-gray-300"}}});return(c,l)=>(a(),d(s(j),T(e,{"as-child":e.asChild,as:e.as,class:s(E)(s(n)({status:e.status}),e.class)}),{default:h(()=>[(a(),d(B(t[e.status]),{class:"w-8 h-8 stroke-3"})),e.status==="active"?(a(),d(K,{key:0,percentage:c.percentage,class:"absolute w-24 h-24 -z-1 top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 [&_circle]:stroke-slate-700",stroke:"red-700"},null,8,["percentage"])):y("",!0)]),_:1},16,["as-child","as","class"]))}}),ee={class:"w-full flex items-center gap-2 mb-8"},te={class:"font-bold text-gray-400 text-xl"},se=g({__name:"list-header",props:{title:{}},setup(r){return(e,t)=>(a(),u("h2",ee,[t[0]||(t[0]=p("div",{class:"h-0.5 flex-grow bg-gray-200"},null,-1)),p("span",te,v(e.title),1),t[1]||(t[1]=p("div",{class:"h-0.5 flex-grow bg-gray-200"},null,-1))]))}}),re={class:"font-bold text-lg text-gray-800"},ae={class:"flex items-center justify-center w-16 h-full"},ne=g({__name:"unit-desc-card",props:{title:{},subtitle:{}},setup(r){const e=r;return(t,n)=>(a(),d(s(q),{class:"relative z-80 flex-row gap-0 py-0"},{default:h(()=>[b(s(O),{class:"gap-0 flex-grow p-4"},{default:h(()=>[b(s(Q),{class:"uppercase font-semibold text-gray-600"},{default:h(()=>[F(v(e.title),1)]),_:1}),p("p",re,v(e.subtitle),1)]),_:1}),b(s(H),{class:"flex items-center p-0 border-l-2 border-gray-200"},{default:h(()=>[p("button",ae,[b(s(X),{class:"w-8 h-8 stroke-gray-800"})])]),_:1})]),_:1}))}});function oe(r){const e=k([]),t=k({unitTitle:r.value?.[0].title??"",unitNumber:r.value?.[0].number??0});U(e,l=>{const o=l.find(i=>i.isIntersecting);if(!o)return;const f=c(o.target);f&&n(f)},{threshold:.7});function n(l){const o=r.value?.find(f=>f.number===l)?.title;o&&(t.value={unitTitle:o,unitNumber:l})}function c(l){const o=l.getAttribute("data-unit");return o?parseInt(o):null}return{targetRefs:e,desc:t}}const ce={key:0},le={key:1},ie=["data-unit"],ue={class:"flex flex-col items-center gap-6"},fe=g({__name:"units-list",props:{sectionNumber:{},data:{},isFetching:{type:Boolean},error:{}},setup(r,{expose:e}){const t=r,{data:n}=z(t),c=k(null);e({root:c});const{targetRefs:l,desc:o}=oe(n),f=R();return(i,S)=>(a(),u("div",{class:"flex flex-col items-center gap-8",ref_key:"root",ref:c},[i.isFetching?(a(),u("p",ce,"Loading...")):y("",!0),i.error?(a(),u("p",le,"An error occurred")):y("",!0),s(n)?.length&&s(o).unitTitle?(a(),d(ne,{key:2,title:`Section ${i.sectionNumber}, Unit ${s(o).unitNumber}`,subtitle:s(o).unitTitle,class:"fixed top-5 left-4 right-4"},null,8,["title","subtitle"])):y("",!0),(a(!0),u($,null,N(s(n),(_,w)=>(a(),u("div",{class:V(["w-full",{"pt-25":w===0}]),key:_.number,"data-unit":_.number,ref_for:!0,ref_key:"targetRefs",ref:l},[w!==0?(a(),d(se,{key:0,title:_.title},null,8,["title"])):y("",!0),p("div",ue,[(a(!0),u($,null,N(_.lessons,m=>(a(),d(Z,{as:s(D),status:m.status,to:`/sections/${_.sectionNumber}/units/${_.number}/lessons/${m.number}/variants/${m.currentVariant}`,key:m.number,percentage:(s(f).progress.lesson.variant-1)/m.totalVariants*100},null,8,["as","status","to","percentage"]))),128))])],10,ie))),128))],512))}});function pe(r,e={}){return I(`/sections/${r}/units`,e).json()}function de(r,e){const t=L();P(r,async()=>{await n()});async function n(){if(!r.value?.length||!t.value?.root)return;await A();const c=t.value.root;_e(c,e)}return{listRef:t}}function _e(r,e){const t=r.querySelector(`[data-unit="${e}"]`);t&&t.scrollIntoView({block:"start"})}const ge={class:"relative"},ve=g({__name:"units-page",setup(r){const e=M(),t=parseInt(e.params.sectionNumber),n=R(),{data:c,isFetching:l,error:o}=pe(t,{afterFetch({data:i}){return i?(n.units=i,{data:n.convertUnitToUnitWithProgress(i)}):{data:i}}}),{listRef:f}=de(c,n.progress.lesson.unit);return(i,S)=>(a(),u("div",ge,[b(s(fe),{ref_key:"listRef",ref:f,sectionNumber:s(t),data:s(c),"is-fetching":s(l),error:s(o)},null,8,["sectionNumber","data","is-fetching","error"])]))}});export{ve as default};
